function LIST(id){var listObj=null;var listBody=null;var listLeft=null;var listMiddle=null;var listRight=null;var rightImg=null;var rightAllImg=null;var leftImg=null;var leftAllImg=null;this.id=id;this.leftOriginalLength=null;this.rightOriginalLength=null;this.leftCanAdd=true;this.leftCanRemove=true;this.rightCanAdd=true;this.rightCanRemove=true;this.initList=initList;this.getListObj=getListObj;this.getRightObj=getRightObj;this.getLeftObj=getLeftObj;this.getMiddleObj=getMiddleObj;this.getMoveRightBtn=getMoveRightBtn;this.getMoveRightAllBtn=getMoveRightAllBtn;this.getMoveLeftBtn=getMoveLeftBtn;this.getMoveLeftAllBtn=getMoveLeftAllBtn;this.getAllObjects=getAllObjects;this.radioMoveRight=radioMoveRight;this.radioMoveLeft=radioMoveLeft;this.multiMoveRight=multiMoveRight;this.multiMoveLeft=multiMoveLeft;this.multiMoveRightAll=multiMoveRightAll;this.multiMoveLeftAll=multiMoveLeftAll;this.limit_MoveRight=limit_MoveRight;this.limit_MoveLeft=limit_MoveLeft;this.limit_MoveRightAll=limit_MoveRightAll;this.limit_MoveLeftAll=limit_MoveLeftAll;this.getRightOptionsValues=getRightOptionsValues;this.getLeftOptionsValues=getLeftOptionsValues;this.getRightOptionsLabels=getRightOptionsLabels;this.getLeftOptionsLabels=getLeftOptionsLabels;this.getRightOptions=getRightOptions;this.getLeftOptions=getLeftOptions;};function initList(type,isdisabled){if(type==null||type==""){alert("List类型未定义!");return;};this.getAllObjects();this.leftOriginalLength=listLeft.options.length;this.rightOriginalLength=listRight.options.length;if(type=="oneImg"&&isdisabled=="false"){var str=this.id+".radioMoveRight()";var click=new Function(str);listLeft.attachEvent("ondblclick",click);rightImg.attachEvent("onclick",click);var str1=this.id+".radioMoveLeft()";var click1=new Function(str1);listRight.attachEvent("ondblclick",click1);leftImg.attachEvent("onclick",click1);};if(type=="multiImg"&&isdisabled=="false"){var str2=this.id+".multiMoveRight()";var click2=new Function(str2);listLeft.attachEvent("ondblclick",click2);rightImg.attachEvent("onclick",click2);var str3=this.id+".multiMoveLeft()";var click3=new Function(str3);listRight.attachEvent("ondblclick",click3);leftImg.attachEvent("onclick",click3);if(leftAllImg!=null){var str4=this.id+".multiMoveLeftAll()";var click4=new Function(str4);leftAllImg.attachEvent("onclick",click4);};if(rightAllImg!=null){var str5=this.id+".multiMoveRightAll()";var click5=new Function(str5);rightAllImg.attachEvent("onclick",click5);};};if(type=="limitMoveRight"&&isdisabled=="false"){var str21=this.id+".limit_MoveRight()";var click21=new Function(str21);listLeft.attachEvent("ondblclick",click21);rightImg.attachEvent("onclick",click21);var str31=this.id+".multiMoveLeft()";var click31=new Function(str31);listRight.attachEvent("ondblclick",click31);leftImg.attachEvent("onclick",click31);if(leftAllImg!=null){var str41=this.id+".multiMoveLeftAll()";var click41=new Function(str41);leftAllImg.attachEvent("onclick",click41);};if(rightAllImg!=null){var str51=this.id+".limit_MoveRightAll()";var click51=new Function(str51);rightAllImg.attachEvent("onclick",click51);};};if(type=="limitMoveLeft"&&isdisabled=="false"){var str22=this.id+".multiMoveRight()";var click22=new Function(str22);listLeft.attachEvent("ondblclick",click22);rightImg.attachEvent("onclick",click22);var str32=this.id+".limit_MoveLeft()";var click32=new Function(str32);listRight.attachEvent("ondblclick",click32);leftImg.attachEvent("onclick",click32);if(leftAllImg!=null){var str42=this.id+".limit_MoveLeftAll()";var click42=new Function(str42);leftAllImg.attachEvent("onclick",click42);};if(rightAllImg!=null){var str52=this.id+".multiMoveRightAll()";var click52=new Function(str52);rightAllImg.attachEvent("onclick",click52);};};};function getAllObjects(){this.getListObj();this.getLeftObj();this.getMiddleObj();this.getRightObj();this.getMoveRightBtn();this.getMoveRightAllBtn();this.getMoveLeftBtn();this.getMoveLeftAllBtn();};function getListObj(){listObj=document.getElementById(this.id);if(listObj==null||(listObj.tagName!="TABLE")){alert("List标签错误--非Table!");return;};listBody=listObj.rows[0];if(listBody==null||(listBody.tagName!="TR")){alert("List标签错误--Table无TR!");return;};return listObj;};function getLeftObj(){var listBodyChild=listObj.rows[0].cells[0];if(listBodyChild==null||(listBodyChild.tagName!="TD")){alert("List标签错误--ListLeft无TD!");return;};listLeft=listBodyChild.children[0];if(listLeft==null||(listLeft.tagName!="SELECT")){alert("List标签错误--listLeft非SELECT!");return;};return listLeft;};function getMiddleObj(){var listBodyChild=listObj.rows[0].cells[1];if(listBodyChild==null||(listBodyChild.tagName!="TD")){alert("List标签错误--ListRight无TD!");return;};listMiddle=listBodyChild.children[0];if(listMiddle==null||(listMiddle.tagName!="P")){alert("List标签错误--listMiddle非P!");return;};return listMiddle;};function getRightObj(){var listBodyChild=listObj.rows[0].cells[2];if(listBodyChild==null||(listBodyChild.tagName!="TD")){alert("List标签错误--ListRight无TD!");return;};listRight=listBodyChild.children[0];if(listRight==null||(listRight.tagName!="SELECT")){alert("List标签错误--listRight非SELECT!");return;};return listLeft;};function getMoveRightBtn(){rightImg=listMiddle.children[0];if(rightImg==null||(rightImg.tagName!="IMG")){alert("List标签错误--右移动按钮非IMG!");return;};return rightImg;};function getMoveRightAllBtn(){if(listMiddle.children.length==8){rightAllImg=listMiddle.children[2];if(rightAllImg==null||rightAllImg.tagName!="IMG"){alert("List标签错误--缺少IMG!");return;};}else if(listMiddle.children.length==5){rightAllImg=null;};return rightAllImg;};function getMoveLeftBtn(){if(listMiddle.children.length==8){leftImg=listMiddle.children[5];if(leftImg==null||(leftImg.tagName!="IMG")){alert("List标签错误--缺少IMG!");return;};}else if(listMiddle.children.length==5){leftImg=listMiddle.children[3];if(leftImg==null||(leftImg.tagName!="IMG")){alert("List标签错误--缺少IMG!");return;};};return leftImg;};function getMoveLeftAllBtn(){if(listMiddle.children.length==8){leftAllImg=listMiddle.children[7];if(leftAllImg==null||(leftAllImg.tagName!="IMG")){alert("List标签错误--缺少IMG!");return;};}else if(listMiddle.children.length==5){leftAllImg=null;};return leftAllImg;};function radioMoveRight(){this.getAllObjects();var leftLength=listLeft.options.length;var selednum=0;for(var i=leftLength-1;i>=0;i--){if(listLeft.options[i].selected){selednum++;};};if(selednum>1){alert("只能选择一项进行右移！");return;};var rightLength=listRight.options.length;if(rightLength>1){return;};if(rightLength==1){var opi=listRight.options[0];if(opi!=null){if(this.leftCanAdd&&!hasOption(opi,this.getLeftOptions())){var opn=document.createElement("<OPTION>");listLeft.options.add(opn);opn.innerText=opi.innerText;opn.value=opi.value;};if(this.rightCanRemove)listRight.options.remove(0);};};for(var i=leftLength-1;i>=0;i--){if(listLeft.options[i].selected){if(this.rightCanAdd&&!hasOption(listLeft.options[i],this.getRightOptions())){var opn=document.createElement("<OPTION>");listRight.options.add(opn);opn.innerText=listLeft.options[i].innerText;opn.value=listLeft.options[i].value;};if(this.leftCanRemove)listLeft.options.remove(i);};};};function radioMoveLeft(){this.getAllObjects();var rightLength=listRight.options.length;for(var i=rightLength-1;i>=0;i--){if(listRight.options[i].selected){if(this.leftCanAdd&&!hasOption(listRight.options[i],this.getLeftOptions())){var opn=document.createElement("<OPTION>");listLeft.options.add(opn);opn.innerText=listRight.options[i].innerText;opn.value=listRight.options[i].value;};if(this.rightCanRemove)listRight.options.remove(i);};};};function multiMoveRight(){this.getAllObjects();var leftLength=listLeft.options.length;for(var i=leftLength-1;i>=0;i--){if(listLeft.options[i].selected){if(this.rightCanAdd&&!hasOption(listLeft.options[i],this.getRightOptions())){var opn=document.createElement("<OPTION>");listRight.options.add(opn);opn.innerText=listLeft.options[i].innerText;opn.value=listLeft.options[i].value;};if(this.leftCanRemove)listLeft.options.remove(i);};};};function multiMoveLeft(){this.getAllObjects();var rightLength=listRight.options.length;for(var i=rightLength-1;i>=0;i--){if(listRight.options[i].selected){if(this.leftCanAdd&&!hasOption(listRight.options[i],this.getLeftOptions())){var opn=document.createElement("<OPTION>");listLeft.options.add(opn);opn.innerText=listRight.options[i].innerText;opn.value=listRight.options[i].value;};if(this.rightCanRemove)listRight.options.remove(i);};};};function multiMoveRightAll(){this.getAllObjects();var leftLength=listLeft.options.length;for(var i=leftLength-1;i>=0;i--){if(this.rightCanAdd&&!hasOption(listLeft.options[i],this.getRightOptions())){var opn=document.createElement("<OPTION>");listRight.options.add(opn);opn.innerText=listLeft.options[i].innerText;opn.value=listLeft.options[i].value;};if(this.leftCanRemove)listLeft.options.remove(i);};};function multiMoveLeftAll(){this.getAllObjects();var rightLength=listRight.options.length;for(var i=rightLength-1;i>=0;i--){if(this.leftCanAdd&&!hasOption(listRight.options[i],this.getLeftOptions())){var opn=document.createElement("<OPTION>");listLeft.options.add(opn);opn.innerText=listRight.options[i].innerText;opn.value=listRight.options[i].value;};if(this.rightCanRemove)listRight.options.remove(i);};};function limit_MoveLeft(){this.getAllObjects();var rightLength=listRight.options.length;for(var i=rightLength-1;i>=this.rightOriginalLength;i--){if(listRight.options[i].selected){if(this.leftCanAdd&&!hasOption(listRight.options[i],this.getLeftOptions())){var opn=document.createElement("<OPTION>");listLeft.options.add(opn);opn.innerText=listRight.options[i].innerText;opn.value=listRight.options[i].value;};if(this.rightCanRemove)listRight.options.remove(i);};};};function limit_MoveLeftAll(){this.getAllObjects();var rightLength=listRight.options.length;for(var i=rightLength-1;i>=this.rightOriginalLength;i--){if(this.leftCanAdd&&!hasOption(listRight.options[i],this.getLeftOptions())){var opn=document.createElement("<OPTION>");listLeft.options.add(opn);opn.innerText=listRight.options[i].innerText;opn.value=listRight.options[i].value;};if(this.rightCanRemove)listRight.options.remove(i);};};function limit_MoveRight(){this.getAllObjects();var leftLength=listLeft.options.length;for(var i=leftLength-1;i>=this.leftOriginalLength;i--){if(listLeft.options[i].selected){if(this.rightCanAdd&&!hasOption(listLeft.options[i],this.getRightOptions())){var opn=document.createElement("<OPTION>");listRight.options.add(opn);opn.innerText=listLeft.options[i].innerText;opn.value=listLeft.options[i].value;};if(this.leftCanRemove)listLeft.options.remove(i);};};};function limit_MoveRightAll(){this.getAllObjects();var leftLength=listLeft.options.length;alert("leftLength->"+leftLength);alert("this.leftOriginalLength->"+this.leftOriginalLength);for(var i=leftLength-1;i>=this.leftOriginalLength;i--){if(this.rightCanAdd&&!hasOption(listLeft.options[i],this.getRightOptions())){var opn=document.createElement("<OPTION>");listRight.options.add(opn);opn.innerText=listLeft.options[i].innerText;opn.value=listLeft.options[i].value;};if(this.leftCanRemove)listLeft.options.remove(i);};};function getRightOptions(){this.getAllObjects();var rightListOptions="";var rightLength=listRight.options.length;for(var i=0;i<=rightLength-1;i++){if(i==rightLength-1){rightListOptions=rightListOptions+listRight.options[i].innerText+",";rightListOptions=rightListOptions+listRight.options[i].value;}else{rightListOptions=rightListOptions+listRight.options[i].innerText+",";rightListOptions=rightListOptions+listRight.options[i].value+";";};};return rightListOptions;};function getLeftOptions(){this.getAllObjects();var leftListOptions="";var leftLength=listLeft.options.length;for(var i=0;i<=leftLength-1;i++){if(i==leftLength-1){leftListOptions=leftListOptions+listLeft.options[i].innerText+",";leftListOptions=leftListOptions+listLeft.options[i].value;}else{leftListOptions=leftListOptions+listLeft.options[i].innerText+",";leftListOptions=leftListOptions+listLeft.options[i].value+";";};};return leftListOptions;};function getRightOptionsValues(){this.getAllObjects();var rightListOptions="";var rightLength=listRight.options.length;for(var i=0;i<=rightLength-1;i++){if(i==rightLength-1){rightListOptions=rightListOptions+listRight.options[i].value;}else{rightListOptions=rightListOptions+listRight.options[i].value+",";};};return rightListOptions;};function getLeftOptionsValues(){this.getAllObjects();var leftListOptions="";var leftLength=listLeft.options.length;for(var i=0;i<=leftLength-1;i++){if(i==leftLength-1){leftListOptions=leftListOptions+listLeft.options[i].value;}else{leftListOptions=leftListOptions+listLeft.options[i].value+",";};};return leftListOptions;};function getRightOptionsLabels(){this.getAllObjects();var rightListOptions="";var rightLength=listRight.options.length;for(var i=0;i<=rightLength-1;i++){if(i==rightLength-1){rightListOptions=rightListOptions+listRight.options[i].innerText;}else{rightListOptions=rightListOptions+listRight.options[i].innerText+",";};};return rightListOptions;};function getLeftOptionsLabels(){this.getAllObjects();var leftListOptions="";var leftLength=listLeft.options.length;for(var i=0;i<=leftLength-1;i++){if(i==leftLength-1){leftListOptions=leftListOptions+listLeft.options[i].innerText;}else{leftListOptions=leftListOptions+listLeft.options[i].innerText+",";};};return leftListOptions;};function hasOption(opi,sel){if(opi.tagName!="OPTION")return;var sel_arr=sel.split(";");var opi_str=opi.innerText+","+opi.value;var len=sel_arr.length;for(var i=0;i<len;i++)if(sel_arr[i]==opi_str)return true;return false;};
